<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Puzzle Card</title>
<style>
  *{box-sizing:border-box}body,html{margin:0;height:100%;display:flex;justify-content:center;align-items:center;background:transparent;}
  #canvas{cursor:pointer;border-radius:12px;box-shadow:0 4px 15px rgba(0,0,0,.4)}
  #msg{position:absolute;max-width:90%;text-align:center;font:700 1.2rem Arial;color:#00bfff;opacity:0;transition:opacity .6s}
</style>
</head>
<body>
<canvas id="canvas"></canvas>
<div id="msg"></div>

<script>
const {img:imgURL,msg} = Object.fromEntries(new URLSearchParams(location.search));
const img=new Image(); img.crossOrigin='anonymous'; img.src=imgURL;
const cvs=document.getElementById('canvas'),ctx=cvs.getContext('2d');
const pieces=[], rows=8, cols=8, pieceW=150/cols, pieceH=150/rows;
img.onload=()=>{cvs.width=img.width;cvs.height=img.height;ctx.drawImage(img,0,0);
  for(let r=0;r<rows;r++)for(let c=0;c<cols;c++){pieces.push({x:c*pieceW,y:r*pieceH,dx:0,dy:0})}
};
cvs.onclick=()=>{
  pieces.forEach(p=>{
    p.dx=(Math.random()-.5)*200; p.dy=(Math.random()-.5)*200;
  });
  let t=0; const anim=()=>{
    ctx.clearRect(0,0,cvs.width,cvs.height);
    pieces.forEach(p=>{
      ctx.save(); ctx.beginPath(); ctx.rect(p.x,p.y,pieceW,pieceH); ctx.clip();
      ctx.drawImage(img,p.x,p.y);
      ctx.restore();
      p.x+=p.dx*.03; p.y+=p.dy*.03; p.dx*=.95; p.dy*=.95;
    });
    if(t<60){t++; requestAnimationFrame(anim);}else showMsg();
  }; anim();
};
function showMsg(){
  const m=document.getElementById('msg'); m.textContent=msg; m.style.opacity=1;
}
</script>
</body>
</html>
